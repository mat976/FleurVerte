{% extends 'base.html.twig' %}

{% block title %}Mon Panier - FleurVerte{% endblock %}

{% block body %}
{# Page Panier - Design lÃ©ger et transparent #}
<div class="min-h-screen bg-white relative overflow-hidden">
	{# Formes dÃ©coratives flottantes #}
	<div class="absolute inset-0 overflow-hidden pointer-events-none">
		<div class="absolute top-20 left-10 w-72 h-72 bg-green-100/30 rounded-full blur-3xl animate-float"></div>
		<div class="absolute top-40 right-20 w-96 h-96 bg-emerald-100/25 rounded-full blur-3xl animate-float-slow"></div>
		<div class="absolute bottom-40 left-1/4 w-64 h-64 bg-teal-100/20 rounded-full blur-3xl animate-float-delay"></div>
		<div class="absolute top-32 right-1/4 text-green-200/20 text-8xl animate-pulse-soft">ðŸ›’</div>
		<div class="absolute bottom-20 left-16 text-emerald-100/15 text-7xl animate-float">ðŸŒ¸</div>
	</div>

	<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-16 py-16 relative z-10">
		{# Header #}
		<div class="text-center mb-12">
			<div class="inline-flex items-center gap-2 px-5 py-2 bg-green-50/80 backdrop-blur-sm rounded-full border border-green-100 mb-6">
				<i class="fas fa-shopping-bag text-green-600"></i>
				<span class="text-green-700 font-medium text-sm">Votre sÃ©lection</span>
			</div>
			<h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">Mon Panier</h1>
		</div>

		{# Flash Messages #}
		{% for message in app.flashes('success') %}
			<div class="bg-green-50 border border-green-200 text-green-700 px-6 py-4 rounded-2xl mb-6 flex items-center gap-3">
				<i class="fas fa-check-circle text-green-500"></i>
				<span>{{ message }}</span>
			</div>
		{% endfor %}
		{% for message in app.flashes('error') %}
			<div class="bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-2xl mb-6 flex items-center gap-3">
				<i class="fas fa-exclamation-circle text-red-500"></i>
				<span>{{ message }}</span>
			</div>
		{% endfor %}

		{% if cartItems is empty %}
			{# Panier vide #}
			<div class="max-w-lg mx-auto text-center bg-white/70 backdrop-blur-sm rounded-3xl p-12 border border-white/50 shadow-lg">
				<div class="w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mx-auto mb-6">
					<i class="fas fa-shopping-bag text-green-400 text-4xl"></i>
				</div>
				<h3 class="text-2xl font-bold text-gray-900 mb-3">Votre panier est vide</h3>
				<p class="text-gray-500 mb-8">DÃ©couvrez notre collection de fleurs fraÃ®ches et ajoutez vos favoris !</p>
				<a href="{{ path('app_product') }}" class="inline-flex items-center gap-2 bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-xl font-semibold transition-all hover:shadow-lg hover:-translate-y-0.5">
					<i class="fas fa-leaf"></i>
					DÃ©couvrir nos fleurs
				</a>
			</div>
		{% else %}
			{# Contenu du panier #}
			<div class="bg-white/70 backdrop-blur-sm rounded-3xl border border-white/50 shadow-lg overflow-hidden">
				{# Liste des articles #}
				<div class="divide-y divide-gray-100">
					{% for item in cartItems %}
						<div class="p-6 flex flex-col sm:flex-row items-center gap-6 hover:bg-white/50 transition-colors">
							{# Image #}
							<div class="w-24 h-24 bg-gray-100 rounded-2xl overflow-hidden flex-shrink-0">
								<img src="{{ asset(item.fleur.getImageUrl()) }}" alt="{{ item.fleur.nom }}" class="w-full h-full object-cover">
							</div>
							
							{# Infos produit #}
							<div class="flex-1 text-center sm:text-left">
								<h3 class="font-bold text-lg text-gray-900 mb-1">{{ item.fleur.nom }}</h3>
								<p class="text-green-600 font-semibold">{{ item.fleur.prix|number_format(2, ',', ' ') }}â‚¬</p>
							</div>
							
							{# QuantitÃ© #}
							<form action="{{ path('app_cart_update', {'id': item.id}) }}" method="POST" class="flex items-center gap-3">
								<div class="flex items-center bg-gray-50 rounded-xl overflow-hidden">
									<input type="number" name="quantity" value="{{ item.quantity }}" min="1" 
										class="w-16 py-2 text-center bg-transparent border-0 focus:ring-0 font-semibold text-gray-700">
								</div>
								<button type="submit" class="w-10 h-10 bg-green-100 hover:bg-green-200 text-green-600 rounded-xl flex items-center justify-center transition-colors">
									<i class="fas fa-sync-alt text-sm"></i>
								</button>
							</form>
							
							{# Total ligne #}
							<div class="text-right">
								<p class="text-sm text-gray-500 mb-1">Total</p>
								<p class="font-bold text-xl text-gray-900">{{ item.total|number_format(2, ',', ' ') }}â‚¬</p>
							</div>
							
							{# Supprimer #}
							<form action="{{ path('app_cart_remove', {'id': item.id}) }}" method="POST">
								<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ item.id) }}">
								<button type="submit" class="w-10 h-10 bg-red-50 hover:bg-red-100 text-red-500 rounded-xl flex items-center justify-center transition-colors">
									<i class="fas fa-trash-alt text-sm"></i>
								</button>
							</form>
						</div>
					{% endfor %}
				</div>

				{# Total et actions #}
				<div class="bg-gray-50/50 p-6 border-t border-gray-100">
					<div class="flex flex-col sm:flex-row items-center justify-between gap-6">
						<div class="text-center sm:text-left">
							<p class="text-gray-500 mb-1">Total de la commande</p>
							<p class="text-3xl font-bold text-gray-900">{{ total|number_format(2, ',', ' ') }}â‚¬</p>
						</div>
						<div class="flex flex-wrap gap-3 justify-center">
							<form action="{{ path('app_cart_clear') }}" method="POST">
								<button type="submit" class="inline-flex items-center gap-2 bg-white border border-gray-200 text-gray-600 hover:bg-gray-50 px-5 py-3 rounded-xl font-semibold transition-all">
									<i class="fas fa-trash"></i>
									Vider
								</button>
							</form>
							<button class="inline-flex items-center gap-2 bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-xl font-semibold transition-all hover:shadow-lg hover:-translate-y-0.5">
								<i class="fas fa-credit-card"></i>
								Payer {{ total|number_format(2, ',', ' ') }}â‚¬
							</button>
						</div>
					</div>
				</div>
			</div>

			{# Continuer les achats #}
			<div class="text-center mt-8">
				<a href="{{ path('app_product') }}" class="inline-flex items-center gap-2 text-green-600 hover:text-green-700 font-semibold transition-colors">
					<i class="fas fa-arrow-left"></i>
					Continuer mes achats
				</a>
			</div>
		{% endif %}
	</div>
</div>
{% endblock %}
